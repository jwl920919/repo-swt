<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="UI_Query">
	<!-- Query Type : Select(Select, Insert, Update, Delete) -->
	<!-- Insert Date : 2016-06-21 -->
	<!-- Insert User : KCM -->
	<!-- Description : 데시보드 메뉴 데이터 조회 -->
	<!-- Controller : -->
	<select id="select_UI_MENU_MASTER" resultType="java.util.HashMap">
		SELECT
		"menu_master"."master_cd", "menu_master"."master_namekey",
		"menu_master"."master_desc",
		"menu_master"."master_order",
		"menu_master"."master_url", "menu_master"."master_icon",
		"menu_sub"."sub_cd", "menu_sub"."subname_key", "menu_sub"."sub_desc",
		"menu_sub"."sub_order",
		"menu_sub"."sub_Url", "menu_sub"."sub_icon",
		"menu_sub"."controller_mapping"
		FROM "menu_master"
		RIGHT OUTER JOIN
		"menu_sub"
		ON "menu_master"."master_cd" = "menu_sub"."master_cd"
		WHERE
		"menu_sub"."display_yn" = TRUE
		ORDER BY "menu_master"."master_order",
		"menu_sub"."sub_order";
	</select>

	<!-- Query Type : Select(Select, Insert, Update, Delete) -->
	<!-- Insert Date : 2016-07-07 -->
	<!-- Insert User : 이재원 -->
	<!-- Description : systemUserManagement.jsp 페이지 테이블 행 개수 조회 -->
	<!-- Controller : MVC.ShinwooTNS.action.ConfigManagementActionController -->
	<select id="select_SYSTEM_USER_INFO_CONDITIONAL_SEARCH_TOTAL_COUNT"
		parameterType="hashmap" resultType="Integer">
		SELECT count(*) AS total
		FROM
		SYSTEM_USER_INFO
		WHERE user_id like #{searchValue} OR user_name
		like
		#{searchValue}
	</select>

	<!-- Query Type : Select(Select, Insert, Update, Delete) -->
	<!-- Insert Date : 2016-07-07 -->
	<!-- Insert User : 이재원 -->
	<!-- Description : systemUserManagement.jsp 페이지 테이블 정보 조회 -->
	<!-- Controller : MVC.ShinwooTNS.action.ConfigManagementActionController -->
	<select id="select_SYSTEM_USER_INFO_CONDITIONAL_SEARCH"
		parameterType="hashmap" resultType="Common.DTO.SYSTEM_USER_INFO_DTO">
		SELECT
		site_id,user_seq,group_id,user_id,user_pw,user_name,dept_name,position_name,phone_num,mobile_num,email,mysingle_yn,insert_date,modify_date
		FROM SYSTEM_USER_INFO
		WHERE user_id like #{searchValue} OR user_name
		like #{searchValue}
		<trim prefix="ORDER BY">
			<if test="orderColumn == 'user_id'"> user_id </if>
			<if test="orderColumn == 'user_name'"> user_name </if>
			<if test="orderType == 'asc'"> ASC </if>
			<if test="orderType == 'desc'"> DESC </if>
		</trim>
		offset #{startIndex} limit #{length};
	</select>

	<!-- Query Type : Select(Select, Insert, Update, Delete) -->
	<!-- Insert Date : 2016-07-11 -->
	<!-- Insert User : 이재원 -->
	<!-- Description : 유저 정보 조회 (Only Record One) -->
	<!-- Controller : MVC.ShinwooTNS.action.ConfigManagementActionController -->
	<select id="select_SYSTEM_USER_INFO_ONE_SEARCH" parameterType="hashmap"
		resultType="Common.DTO.SYSTEM_USER_INFO_DTO">
		SELECT
		site_id,user_seq,group_id,user_id,user_pw,user_name,dept_name,position_name,phone_num,mobile_num,email,mysingle_yn,insert_date,modify_date
		FROM SYSTEM_USER_INFO WHERE user_id=#{user_id};
	</select>

	<!-- Query Type : Update(Select, Insert, Update, Delete) -->
	<!-- Insert Date : 2016-07-11 -->
	<!-- Insert User : 이재원 -->
	<!-- Description : 유저 정보 변경 (Only Record One) -->
	<!-- Controller : MVC.ShinwooTNS.action.ConfigManagementActionController -->
	<update id="update_SYSTEM_USER_INFO_ONE_RECORD" parameterType="hashmap">
		SET TIMEZONE to #{time_zone};
		UPDATE system_user_info set <if test="user_pw != ''">user_pw=#{user_pw},</if> user_name=#{user_name},group_id=#{group_id},site_id=#{site_id},dept_name=#{dept_name},position_name=#{position_name},email=#{email},phone_num=#{phone_num},mobile_num=#{mobile_num},modify_date=now() WHERE user_id=#{user_id};
	</update>

	<!-- Query Type : Insert(Select, Insert, Update, Delete) -->
	<!-- Insert Date : 2016-07-11 -->
	<!-- Insert User : 이재원 -->
	<!-- Description : 유저 정보 추가 (Only Record One) -->
	<!-- Controller : MVC.ShinwooTNS.action.ConfigManagementActionController -->
	<insert id="insert_SYSTEM_USER_INFO_ONE_RECORD" parameterType="hashmap">
		SET TIMEZONE to #{time_zone};
		INSERT into
		system_user_info (site_id, user_id, user_pw,
		user_name, group_id, dept_name, position_name, phone_num,
		mobile_num, email, mysingle_yn, insert_date, modify_date) VALUES (#{site_id}, #{user_id}, #{user_pw},
		#{user_name}, #{group_id}, #{dept_name}, #{position_name}, #{phone_num},
		#{mobile_num}, #{email}, false, now(), now());
	</insert>


	<!-- Query Type : Select(Select, Insert, Update, Delete) -->
	<!-- Insert Date : 2016-07-11 -->
	<!-- Insert User : 이재원 -->
	<!-- Description : 시스템 유저 그룹 정보 조회 -->
	<!-- Controller : MVC.ShinwooTNS.action.ConfigManagementActionController -->
	<select id="select_SYSTEM_USER_GROUP_INFO" resultType="Common.DTO.SYSTEM_USER_GROUP_DTO">
		SELECT
		site_id,group_id,group_name,group_desc FROM system_user_group;
	</select>

	<!-- Query Type : Select(Select, Insert, Update, Delete) -->
	<!-- Insert Date : 2016-07-11 -->
	<!-- Insert User : 이재원 -->
	<!-- Description : 사업장 정보 조회 -->
	<!-- Controller : MVC.ShinwooTNS.action.ConfigManagementActionController -->
	<select id="select_SITE_INFO" resultType="Common.DTO.SITE_INFO_DTO">
		SELECT
		site_id,site_name,site_code,description FROM site_info;
	</select>
	
	<!-- Query Type : Select(Select, Insert, Update, Delete) -->
	<!-- Insert Date : 2016-07-11 -->
	<!-- Insert User : KCM -->
	<!-- Description : IP관리 > 고정IP현황 -->
	<!-- Controller : MVC.ShinwooTNS.action.ConfigManagementActionController -->
	<select id="select_IP_MANAGEMENT_SEGMENT" resultType="java.util.HashMap">
		SET TIMEZONE TO 'Asia/Seoul';	
		SELECT * FROM "test_dhcp_segment"
		 WHERE network like CONCAT('%', #{searchValue}, '%') OR comment like CONCAT('%', #{searchValue}, '%') OR site like CONCAT('%', #{searchValue}, '%')
		<trim prefix="ORDER BY">
			<if test="orderColumn == 'network'"> network </if>
			<if test="orderColumn == 'comment'"> comment </if>
			<if test="orderColumn == 'utilization'"> utilization </if>
			<if test="orderColumn == 'site'"> site </if>
			<if test="orderType == 'asc'"> ASC </if>
			<if test="orderType == 'desc'"> DESC </if>
		</trim>
		offset #{startIndex} limit #{length};
	</select>
	
	
	
</mapper>



<!-- <mapper namespace="testSqlMap" > -->
<!-- <select id="selectTestTable" resultType="java.util.HashMap"> -->

<!-- SELECT * FROM "UI_MENU_MASTER" -->

<!-- </select> -->
<!-- </mapper> -->


